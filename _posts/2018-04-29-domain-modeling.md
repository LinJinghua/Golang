---
layout: post
title: "Domain modeling"
description: 领域建模实践.
image: 'https://www.codebydesign.com/SystemArchitect/ScreenShots/XP/PhysicalModel.png'
category: 'blog'
tags:
- software-system-analysis-and-design
- domain
- modeling
twitter_text: 领域建模实践.
introduction: 领域建模实践.
---

# 领域建模实践

------

## 1. 领域建模
 - a. 阅读 Asg_RH 文档，按用例构建领域模型。
    - 按 Task2 要求，请使用工具 UMLet，截图格式务必是 png 并控制尺寸
    - 说明：请不要受 PCMEF 层次结构影响。你需要识别实体（E）和 中介实体（M，也称状态实体）
        - 在单页面应用（如 vue）中，E 一般与数据库构建有关， M 一般与 [store](https://cn.vuejs.org/v2/guide/state-management.html) 模式 有关
        - 在 java web 应用中，E 一般与数据库构建有关， M 一般与 session 有关
    
    ![Asg_RH Task2 领域模型](/assets/img/blog/domain-modeling-reserve-hotel.png)
 - b. 数据库建模(E-R 模型)
    - 按 Task 3 要求，给出系统的 E-R 模型（数据逻辑模型）
    - 建模工具 PowerDesigner（简称PD） 或开源工具 [OpenSystemArchitect](https://www.codebydesign.com)
    - 不负责的链接 [http://www.cnblogs.com/mcgrady/archive/2013/05/25/3098588.html](https://www.qunar.com)
    - 导出 Mysql 物理数据库的脚本
    - 简单叙说 数据库逻辑模型 与 领域模型 的异同
        - E-R 模型
        
        ![Asg_RH Task1 用例图](/assets/img/blog/domain-modeling-design.png)

        - Mysql 物理数据库的脚本
            ```sql
            -- +---------------------------------------------------------
            -- | MODEL       : Northwind
            -- | AUTHOR      : 
            -- | GENERATED BY: Open System Architect
            -- +---------------------------------------------------------
            -- | WARNING     : Review before execution
            -- +---------------------------------------------------------

            -- +---------------------------------------------------------
            -- | CREATE
            -- +---------------------------------------------------------
            if exists(select 1 from sys.sysforeignkey where role='FK_HOTEL_REFERENCE_LOCATION') then
                alter table hotel
                delete foreign key FK_HOTEL_REFERENCE_LOCATION
            end if;

            if exists(select 1 from sys.sysforeignkey where role='FK_REQUEST_REFERENCE_HOTEL') then
                alter table request
                delete foreign key FK_REQUEST_REFERENCE_HOTEL
            end if;

            if exists(select 1 from sys.sysforeignkey where role='FK_REQUEST_REFERENCE_CONSUMER') then
                alter table request
                delete foreign key FK_REQUEST_REFERENCE_CONSUMER
            end if;

            if exists(select 1 from sys.sysforeignkey where role='FK_ROOM_REFERENCE_HOTEL') then
                alter table room
                delete foreign key FK_ROOM_REFERENCE_HOTEL
            end if;

            if exists(select 1 from sys.sysforeignkey where role='FK_ROOM DES_REFERENCE_ROOM') then
                alter table "room description"
                delete foreign key "FK_ROOM DES_REFERENCE_ROOM"
            end if;

            drop table if exists consumer;

            drop table if exists hotel;

            drop table if exists location;

            drop table if exists request;

            drop table if exists room;

            drop table if exists "room description";

            /*==============================================================*/
            /* Table: consumer                                              */
            /*==============================================================*/
            create table consumer 
            (
            name                 char(20)                       not null,
            email                char(50)                       not null,
            constraint PK_CONSUMER primary key clustered (name)
            );

            /*==============================================================*/
            /* Table: hotel                                                 */
            /*==============================================================*/
            create table hotel 
            (
            name                 char(50)                       not null,
            star                 decimal                        null,
            "index"              char(20)                       not null,
            code                 char(20)                       null,
            address              dec(50)                        null,
            constraint PK_HOTEL primary key clustered ("index")
            );

            /*==============================================================*/
            /* Table: location                                              */
            /*==============================================================*/
            create table location 
            (
            code                 char(20)                       not null,
            name                 char(50)                       not null,
            constraint PK_LOCATION primary key clustered (code, name)
            );

            /*==============================================================*/
            /* Table: request                                               */
            /*==============================================================*/
            create table request 
            (
            "hotel name"         char(50)                       not null,
            city                 char(20)                       null,
            "room type"          char(10)                       not null,
            "check in date"      datetime                       not null,
            "check out date"     datetime                       not null,
            hotel_index          char(20)                       null,
            con_name             char(20)                       null,
            special              char(100)                      null,
            "request index"      char(20)                       not null,
            constraint PK_REQUEST primary key clustered ("check in date", "check out date", "request index")
            );

            /*==============================================================*/
            /* Table: room                                                  */
            /*==============================================================*/
            create table room 
            (
            "room id"            char(10)                       not null,
            "hotel index"        char(20)                       null,
            type                 char(20)                       not null,
            "availble num"       decimal                        not null,
            constraint PK_ROOM primary key clustered ("room id")
            );

            /*==============================================================*/
            /* Table: "room description"                                    */
            /*==============================================================*/
            create table "room description" 
            (
            "room id"            char(10)                       null,
            type                 char(20)                       not null,
            "list price"         double                         not null
            );

            alter table hotel
            add constraint FK_HOTEL_REFERENCE_LOCATION foreign key (code, name)
                references location (code, name)
                on update restrict
                on delete restrict;

            alter table request
            add constraint FK_REQUEST_REFERENCE_HOTEL foreign key (hotel_index)
                references hotel ("index")
                on update restrict
                on delete restrict;

            alter table request
            add constraint FK_REQUEST_REFERENCE_CONSUMER foreign key (con_name)
                references consumer (name)
                on update restrict
                on delete restrict;

            alter table room
            add constraint FK_ROOM_REFERENCE_HOTEL foreign key ("hotel index")
                references hotel ("index")
                on update restrict
                on delete restrict;

            alter table "room description"
            add constraint "FK_ROOM DES_REFERENCE_ROOM" foreign key ("room id")
                references room ("room id")
                on update restrict
                on delete restrict;
            ```
        - 数据库逻辑模型 与 领域模型 的异同
            - 不同：领域模型用于分析，而数据库模型用于开发，需要给出更具体细节，如字段类型。
            - 相同：表达实体、中介之间的关系(约束)。
